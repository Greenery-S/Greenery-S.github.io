<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on Greenery&#39;s Blog Site</title>
        <link>https://Greenery-S.github.io/posts/</link>
        <description>Recent content in Posts on Greenery&#39;s Blog Site</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Sat, 25 May 2024 02:17:44 +0800</lastBuildDate>
        <atom:link href="https://Greenery-S.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Hash Function vs Symmetric Encryption</title>
            <link>https://Greenery-S.github.io/posts/go/encryption/hash-function-vs-symmetric-encryption/</link>
            <pubDate>Wed, 22 May 2024 23:29:47 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/encryption/hash-function-vs-symmetric-encryption/</guid>
            <description>Core Differences between Symmetric Encryption and Hash Functions 1 Symmetric Encryption Purpose: Protect the confidentiality of data, preventing unauthorized access.
Working Principle: Utilizes the same key for both encryption and decryption of data.
Characteristics:
Reversibility: Decrypting ciphertext to retrieve the original data using the same key is possible. Key Management: Securely sharing the key is crucial, as data remains inaccessible without it. Applications: Secure communication, data storage, digital signatures, etc.</description>
            <content type="html"><![CDATA[<h1 id="core-differences-between-symmetric-encryption-and-hash-functions">Core Differences between Symmetric Encryption and Hash Functions</h1>
<h2 id="1-symmetric-encryption">1 Symmetric Encryption</h2>
<p><strong>Purpose:</strong> Protect the confidentiality of data, preventing unauthorized access.</p>
<p><strong>Working Principle:</strong> Utilizes the same key for both encryption and decryption of data.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Reversibility: Decrypting ciphertext to retrieve the original data using the same key is possible.</li>
<li>Key Management: Securely sharing the key is crucial, as data remains inaccessible without it.</li>
</ul>
<p><strong>Applications:</strong> Secure communication, data storage, digital signatures, etc.</p>
<h2 id="2-hash-functions">2 Hash Functions</h2>
<p><strong>Purpose:</strong> Verify the integrity and authenticity of data.</p>
<p><strong>Working Principle:</strong> Converts inputs of any length into fixed-length hash values.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>One-way Property: Deriving the original input from the hash value is computationally infeasible.</li>
<li>Collision Resistance: Finding two different inputs that generate the same hash value is extremely difficult.</li>
<li>Integrity: Any modification to the input will result in a different hash value.</li>
</ul>
<p><strong>Applications:</strong> File integrity verification, password storage, digital signatures, etc.</p>
<h2 id="3-summary">3 Summary</h2>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Symmetric Encryption</th>
<th>Hash Functions</th>
</tr>
</thead>
<tbody>
<tr>
<td>Purpose</td>
<td>Confidentiality</td>
<td>Integrity and Authenticity</td>
</tr>
<tr>
<td>Reversibility</td>
<td>Reversible</td>
<td>Irreversible</td>
</tr>
<tr>
<td>Key Management</td>
<td>Requires Key Management</td>
<td>No Key Management Required</td>
</tr>
<tr>
<td>Output</td>
<td>Encrypted Data</td>
<td>Hash Value</td>
</tr>
</tbody>
</table>
<p>Symmetric encryption and hash functions are both essential cryptographic techniques for safeguarding data security. They differ in their working principles, applications, and security aspects. The choice of technique depends on the specific application requirements.</p>
]]></content>
        </item>
        
        <item>
            <title>Open Compare to Openfile</title>
            <link>https://Greenery-S.github.io/posts/go/memo/open-compare-to-openfile/</link>
            <pubDate>Wed, 22 May 2024 22:15:28 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/memo/open-compare-to-openfile/</guid>
            <description>os.Open vs. os.OpenFile 1 Differences In Go, both os.Open and os.OpenFile are functions used to open files, but they have different usage scenarios and functionalities.
os.Open: This is a simpler function for opening files. It takes only one argument, the path to the file to be opened. It opens the file in read-only mode and returns an error if the file does not exist. file, err := os.Open(&amp;#34;example.txt&amp;#34;) if err !</description>
            <content type="html"><![CDATA[<h1 id="osopen-vs-osopenfile">os.Open vs. os.OpenFile</h1>
<h2 id="1-differences">1 Differences</h2>
<p>In Go, both <code>os.Open</code> and <code>os.OpenFile</code> are functions used to open files, but they have different usage scenarios and functionalities.</p>
<ol>
<li><code>os.Open</code>: This is a simpler function for opening files. It takes only one argument, the path to the file to be opened. It opens the file in read-only mode and returns an error if the file does not exist.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#e6db74">&#34;example.txt&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Close</span>()
</span></span></code></pre></div><ol start="2">
<li><code>os.OpenFile</code>: This is a more powerful function for opening files. It takes three arguments: the file path, the file opening mode, and the file permissions. It can open files in various modes (such as read-only, write-only, read-write, append, create, etc.), and it can create a new file if it does not exist.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">OpenFile</span>(<span style="color:#e6db74">&#34;example.txt&#34;</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_CREATE</span>|<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">O_WRONLY</span>, <span style="color:#ae81ff">0644</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">Close</span>()
</span></span></code></pre></div><p>In this example, <code>os.OpenFile</code> opens the file in write mode. If the file does not exist, it creates a new file. The file permissions are set to 0644, which means that the file owner can read and write to the file, while other users can only read the file.</p>
<p>In general, if you only need to open a file in read-only mode, you can use <code>os.Open</code>. If you need more control (such as setting file permissions or opening files in different modes), you should use <code>os.OpenFile</code>.</p>
<h2 id="2-modes-and-permissions">2 Modes and Permissions</h2>
<p>When using the <code>os.OpenFile</code> function to open or create a file in Go, you need to specify two parameters: mode (flag) and permissions (permission).</p>
<h3 id="mode-flag">Mode (flag)</h3>
<p>This parameter determines how you open the file. Go provides some predefined constants to set this parameter:</p>
<ul>
<li><code>os.O_RDONLY</code>: Opens the file in read-only mode.</li>
<li><code>os.O_WRONLY</code>: Opens the file in write-only mode.</li>
<li><code>os.O_RDWR</code>: Opens the file in read-write mode.</li>
<li><code>os.O_APPEND</code>: When writing data, appends the data to the end of the file instead of overwriting existing content.</li>
<li><code>os.O_CREATE</code>: Creates a new file if it does not exist.</li>
<li><code>os.O_TRUNC</code>: If the file already exists, clears the file&rsquo;s contents before writing data.</li>
</ul>
<p>These constants can be combined using the logical OR operator (<code>|</code>) to set multiple modes. For example, <code>os.O_CREATE|os.O_WRONLY</code> opens the file in write-only mode and creates a new file if it does not exist.</p>
<h3 id="permissions-permission">Permissions (permission)</h3>
<p>This parameter determines the file&rsquo;s permissions. It is an octal number, typically consisting of three digits. Each digit represents the permissions for the file owner, the file&rsquo;s group, and other users.</p>
<ul>
<li>The first digit represents the file owner&rsquo;s permissions.</li>
<li>The second digit represents the permissions of the file&rsquo;s group.</li>
<li>The third digit represents the permissions of other users.</li>
</ul>
<p>Each digit is an integer from 0 to 7, representing the following combinations of permissions:</p>
<ul>
<li>4: Read permission</li>
<li>2: Write permission</li>
<li>1: Execute permission</li>
</ul>
<p>For example:</p>
<ul>
<li>Permission 0644 means that the file owner has read and write permissions (6 = 4 + 2), while the file&rsquo;s group and other users only have read permissions (4).</li>
<li>Permission 0777 means that all users have read, write, and execute permissions.</li>
</ul>
]]></content>
        </item>
        
        <item>
            <title>File Encryption</title>
            <link>https://Greenery-S.github.io/posts/go/encryption/file-encryption/</link>
            <pubDate>Wed, 22 May 2024 17:42:47 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/encryption/file-encryption/</guid>
            <description>File Encryption code: https://github.com/Greenery-S/go-encryption/tree/master/enc_file
1 Symmetric Encryption Every step of the encryption process is reversible The same set of keys is used for encryption and decryption XOR is the simplest symmetric encryption algorithm Typical symmetric encryption algorithms: DES (Data Encryption Standard), AES (Advanced Encryption Standard)
2 Group Encryption Group encryption: The original data (plaintext) is grouped, each group is 64 bits, and when the last group is less than 64 bits, it is filled according to certain rules.</description>
            <content type="html"><![CDATA[<h1 id="file-encryption">File Encryption</h1>
<blockquote>
<p>code: <a href="https://github.com/Greenery-S/go-encryption/tree/master/enc_file">https://github.com/Greenery-S/go-encryption/tree/master/enc_file</a></p>
</blockquote>
<h2 id="1-symmetric-encryption">1 Symmetric Encryption</h2>

    <img src="/images/file-encryption-symmetric.png"  alt="symmetric-encryption"  class="center"  style="border-radius: 0px; width: 50%;"  />


<ul>
<li>Every step of the encryption process is <strong>reversible</strong></li>
<li>The same set of keys is used for <strong>encryption and decryption</strong></li>
<li>XOR is the simplest symmetric encryption algorithm

      <img src="/images/file-encryption-xor.png"  alt="symmetric-encryption"  class="center"  style="border-radius: 0px; width: 80%;"  />
  
</li>
</ul>
<p>Typical symmetric encryption algorithms: DES (Data Encryption Standard), AES (Advanced Encryption Standard)</p>
<h2 id="2-group-encryption">2 Group Encryption</h2>
<ul>
<li>Group encryption: The original data (plaintext) is grouped, each group is 64 bits, and when the last group is less than 64 bits, it is filled according to certain rules. The DES algorithm is applied separately to each group</li>
<li>CBC (Cipher Block Chaining) ciphertext group link mode, the current plaintext group is XORed with the previous ciphertext group, and then encrypted</li>
</ul>

    <img src="/images/file-encryption-cbc.png"  alt="symmetric-encryption"  class="center"  style="border-radius: 0px; width: 100%;"  />


<p>See the code link for the code.</p>
<h3 id="digital-padding">Digital Padding</h3>
<p>PKCS#5 and PKCS#7 are two common data padding standards, both of which are part of the PKCS (Public-Key Cryptography Standards) series of standards.</p>
<ul>
<li>PKCS#5: Mainly used to describe the padding method of block ciphers in cryptography. In practical applications, when the size of the data block is not the fixed length required by the password algorithm, padding is required. The PKCS#5 padding method is to pad a byte sequence at the end of the data block, <strong>each byte&rsquo;s value is equal to the number of missing bytes</strong>. For example, if the data block length is 6, and the <strong>password algorithm requires a length of 8</strong>, two bytes need to be padded at the end of the data block, each byte&rsquo;s value is 2.</li>
<li>PKCS#7: It is an extension of PKCS#5, it supports data blocks of any length, not just 8 bytes. The <strong>padding method of PKCS#7 is the same as PKCS#5</strong>, both are to pad a byte sequence at the end of the data block, each byte&rsquo;s value is equal to the number of missing bytes.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// pkcs7padding and pkcs5padding have the same padding method, the value of the padding byte is equal to the number of padding bytes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// For example, if you need to pad 4 bytes, the padding value is &#34;4 4 4 4&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// only difference is the block size, PKCS5 is 8 bytes, PKCS7 can be any bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">PKCS5</span>          = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">pkcs5</span>{}
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">PKCS7</span>          = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">pkcs5</span>{}
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ErrPaddingSize</span> = <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;padding size error&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// pkcs5Padding is a pkcs5 padding struct.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">pkcs5</span> <span style="color:#66d9ef">struct</span>{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Padding implements the Padding interface Padding method.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">pkcs5</span>) <span style="color:#a6e22e">Padding</span>(<span style="color:#a6e22e">src</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">blockSize</span> <span style="color:#66d9ef">int</span>) []<span style="color:#66d9ef">byte</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">srcLen</span> <span style="color:#f92672">:=</span> len(<span style="color:#a6e22e">src</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//Note: When srcLen is an integer multiple of blockSize, padLen is equal to blockSize rather than 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">padLen</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">blockSize</span> <span style="color:#f92672">-</span> (<span style="color:#a6e22e">srcLen</span> <span style="color:#f92672">%</span> <span style="color:#a6e22e">blockSize</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">padText</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">Repeat</span>([]<span style="color:#66d9ef">byte</span>{byte(<span style="color:#a6e22e">padLen</span>)}, <span style="color:#a6e22e">padLen</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> append(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">padText</span><span style="color:#f92672">...</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Unpadding implements the Padding interface Unpadding method.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">pkcs5</span>) <span style="color:#a6e22e">Unpadding</span>(<span style="color:#a6e22e">src</span> []<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">blockSize</span> <span style="color:#66d9ef">int</span>) ([]<span style="color:#66d9ef">byte</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">srcLen</span> <span style="color:#f92672">:=</span> len(<span style="color:#a6e22e">src</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">paddingLen</span> <span style="color:#f92672">:=</span> int(<span style="color:#a6e22e">src</span>[<span style="color:#a6e22e">srcLen</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">paddingLen</span> <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">srcLen</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">paddingLen</span> &gt; <span style="color:#a6e22e">blockSize</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">ErrPaddingSize</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">src</span>[:<span style="color:#a6e22e">srcLen</span><span style="color:#f92672">-</span><span style="color:#a6e22e">paddingLen</span>], <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">o</span> <span style="color:#f92672">:=</span> []byte(<span style="color:#e6db74">&#34;hello world!&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">PKCS5</span>.<span style="color:#a6e22e">Padding</span>(<span style="color:#a6e22e">o</span>, <span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">u</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">PKCS5</span>.<span style="color:#a6e22e">Unpadding</span>(<span style="color:#a6e22e">p</span>, <span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">p</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// [104 101 108 108 111 32 119 111 114 108 100 33 4 4 4 4]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">u</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// [104 101 108 108 111 32 119 111 114 108 100 33]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h2 id="3-asymmetric-encryption">3 Asymmetric Encryption</h2>

    <img src="/images/file-encryption-asymmetric.png"  alt="asymmetric-encryption"  class="center"  style="border-radius: 0px; width: 50%;"  />


<ul>
<li>Encrypt with the public key, decrypt with the private key</li>
<li>The public key and the private key are different
<ul>
<li>The public key can be published to everyone</li>
<li><strong>The private key is only saved by yourself</strong></li>
</ul>
</li>
<li><strong>The public key is derived from the private key</strong></li>
<li>Compared to symmetric encryption, <strong>the operation speed is very slow</strong></li>
<li>Blockchain technology is the application of asymmetric encryption technology

      <img src="/images/file-encryption-blockchain.png"  alt="asymmetric-encryption"  class="center"  style="border-radius: 0px; width: 80%;"  />
  
</li>
</ul>
<p>Typical asymmetric encryption algorithms: RSA (Ron Rivest, Adi Shamir, Leonard Adleman), ECC (Elliptic Curve Cryptography) elliptic curve encryption algorithm</p>
<p>In the next lecture &ldquo;Digital Signature&rdquo;, we will talk about the go code of asymmetric encryption.</p>
]]></content>
        </item>
        
        <item>
            <title>Introduction to Clickhouse</title>
            <link>https://Greenery-S.github.io/posts/go/database/introduction-to-clickhouse/</link>
            <pubDate>Wed, 22 May 2024 15:08:40 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/database/introduction-to-clickhouse/</guid>
            <description>ClickHouse code: https://github.com/Greenery-S/go-database/tree/master/clickhouse
1 Introduction ClickHouse is a columnar database management system (DBMS) for online analytical processing (OLAP).
In traditional row-based database systems (MySQL, SQL Server), data in the same row is always physically stored together. In columnar database systems (ClickHouse, HBase, Druid), data from the same column is stored together.
Key characteristics of OLAP scenarios (statistical analysis based on event tracking data):
The vast majority are read requests, and data added to the database cannot be modified.</description>
            <content type="html"><![CDATA[<h1 id="clickhouse">ClickHouse</h1>
<blockquote>
<p>code: <a href="https://github.com/Greenery-S/go-database/tree/master/clickhouse">https://github.com/Greenery-S/go-database/tree/master/clickhouse</a></p>
</blockquote>
<h2 id="1-introduction">1 Introduction</h2>
<p>ClickHouse is a columnar database management system (DBMS) for online analytical processing (OLAP).</p>
<p>In traditional row-based database systems (MySQL, SQL Server), data in the same row is always physically stored together. In columnar database systems (ClickHouse, HBase, Druid), data from the same column is stored together.</p>
<p>Key characteristics of OLAP scenarios (statistical analysis based on event tracking data):</p>
<ol>
<li>The vast majority are read requests, and data added to the database cannot be modified.</li>
<li>Wide tables, meaning each table contains a large number of columns.</li>
<li>For reads, a significant number of rows are extracted from the database, but only a small portion of the columns.</li>
<li>Relatively few queries (typically hundreds or fewer per second per server).</li>
<li>For simple queries, a latency of about 50 milliseconds is acceptable.</li>
<li>Data in columns is relatively small: numbers and short strings (e.g., 60 bytes per URL).</li>
<li>High throughput is required when processing a single query (up to billions of rows per second per server).</li>
<li>Transactions are not necessary.</li>
</ol>
<h2 id="2-usage">2 Usage</h2>
<p>Its SQL syntax is similar to MySQL, but there are some differences.</p>
<p>Creating a database and table:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">database</span> test;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- json type is experimental feature
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">set</span> allow_experimental_object_type <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> test.<span style="color:#66d9ef">user</span>
</span></span><span style="display:flex;"><span>(
</span></span><span style="display:flex;"><span>    user_id     UInt32 <span style="color:#66d9ef">comment</span> <span style="color:#e6db74">&#39;User ID&#39;</span>,       <span style="color:#75715e">-- User ID
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    name        String <span style="color:#66d9ef">comment</span> <span style="color:#e6db74">&#39;User Name&#39;</span>,     <span style="color:#75715e">-- User Name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    create_time DateTime <span style="color:#66d9ef">comment</span> <span style="color:#e6db74">&#39;Registration Time&#39;</span>, <span style="color:#75715e">-- Registration Time
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    extra       Json <span style="color:#66d9ef">comment</span> <span style="color:#e6db74">&#39;Additional Info&#39;</span>  <span style="color:#75715e">-- Additional Info, json can freely extend fields
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>) ENGINE <span style="color:#f92672">=</span> MergeTree()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (create_time);
</span></span></code></pre></div><p>Querying data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">WITH</span>
</span></span><span style="display:flex;"><span>    toDateTime(<span style="color:#e6db74">&#39;2023-09-01&#39;</span>, <span style="color:#e6db74">&#39;UTC&#39;</span>) <span style="color:#66d9ef">AS</span> begin_day,
</span></span><span style="display:flex;"><span>    toDateTime(<span style="color:#e6db74">&#39;2023-09-08&#39;</span>, <span style="color:#e6db74">&#39;UTC&#39;</span>) <span style="color:#66d9ef">AS</span> end_day
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> toDate(create_time) <span style="color:#66d9ef">AS</span> date,
</span></span><span style="display:flex;"><span>       uniq(user_id)       <span style="color:#66d9ef">AS</span> <span style="color:#f92672">`</span>Number <span style="color:#66d9ef">of</span> Registered Users<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> test.<span style="color:#66d9ef">user</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> (create_time <span style="color:#f92672">&gt;=</span> begin_day)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">AND</span> (create_time <span style="color:#f92672">&lt;</span> end_day)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> date
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> date;
</span></span></code></pre></div><h2 id="3-go-sdk">3 Go SDK</h2>
<p>See code.</p>
<h2 id="4-creating-dashboards">4 Creating Dashboards</h2>
<p>Generate business reports based on ClickHouse and Grafana.</p>

    <img src="/images/introduction-to-clickhouse-dashboard.png"  alt="dashboard"  class="center"  style="border-radius: 0px; width: 100%;"  />


]]></content>
        </item>
        
        <item>
            <title>Introduction to Mongo</title>
            <link>https://Greenery-S.github.io/posts/go/database/introduction-to-mongo/</link>
            <pubDate>Wed, 22 May 2024 01:23:35 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/database/introduction-to-mongo/</guid>
            <description>MongoDB code: https://github.com/Greenery-S/go-database/tree/master/mongo
1 Introduction Mongo is a document-oriented database, and it contrasts with relational databases as follows. Mongo&amp;rsquo;s greatest feature is its schema flexibility, meaning you can store documents with completely different structures in the same collection. This is especially useful in the early stages of a project when the table fields are not yet stable. Compared to MySQL, Mongo is better suited for storing large, low-value data. The read and write performance for large documents is better in Mongo than in MySQL.</description>
            <content type="html"><![CDATA[<h1 id="mongodb">MongoDB</h1>
<blockquote>
<p>code: <a href="https://github.com/Greenery-S/go-database/tree/master/mongo">https://github.com/Greenery-S/go-database/tree/master/mongo</a></p>
</blockquote>
<h2 id="1-introduction">1 Introduction</h2>

    <img src="/images/introduction-to-mongo-compare-to-mysql.png"  alt="compare-to-mysql"  class="center"  style="border-radius: 0px; width: 80%;"  />


<ul>
<li>Mongo is a document-oriented database, and it contrasts with relational databases as follows.</li>
<li>Mongo&rsquo;s greatest feature is its schema flexibility, meaning you can store documents with completely different structures in the same collection. This is especially useful in the early stages of a project when the table fields are not yet stable.</li>
<li>Compared to MySQL, Mongo is better suited for storing large, low-value data. The read and write performance for large documents is better in Mongo than in MySQL.</li>
</ul>
<h2 id="2-syntax">2 Syntax</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>use test;  <span style="color:#75715e"># Switch to the test database, which will be automatically created if it doesn&#39;t exist when a collection is created</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>show collections  <span style="color:#75715e"># View the collections in the database</span>
</span></span><span style="display:flex;"><span>db.createCollection<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;student&#34;</span><span style="color:#f92672">)</span>;  <span style="color:#75715e"># Create a collection</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db.createUser<span style="color:#f92672">({</span>user: <span style="color:#e6db74">&#34;tester&#34;</span>,pwd: <span style="color:#e6db74">&#34;123456&#34;</span>, roles: <span style="color:#f92672">[{</span>role: <span style="color:#e6db74">&#34;dbAdmin&#34;</span>, db: <span style="color:#e6db74">&#34;test&#34;</span><span style="color:#f92672">}]})</span>; <span style="color:#75715e"># Create a user</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Log in with the newly created tester user:</span>
</span></span><span style="display:flex;"><span>mongo --port <span style="color:#ae81ff">27017</span> -u <span style="color:#e6db74">&#34;tester&#34;</span> -p <span style="color:#e6db74">&#34;123456&#34;</span> --authenticationDatabase <span style="color:#e6db74">&#34;test&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db.student.createIndex<span style="color:#f92672">({</span>name:1,unique:1<span style="color:#f92672">})</span> <span style="color:#75715e"># Create a unique index on the name field, 1 for ascending order, -1 for descending order</span>
</span></span><span style="display:flex;"><span>db.student.dropIndex<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name_1_unique_1&#34;</span><span style="color:#f92672">)</span>  <span style="color:#75715e"># Delete the index</span>
</span></span><span style="display:flex;"><span>db.student.getIndexes<span style="color:#f92672">()</span>  <span style="color:#75715e"># View the indexes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db.student.insertOne<span style="color:#f92672">({</span>name:<span style="color:#e6db74">&#34;张三&#34;</span>,city:<span style="color:#e6db74">&#34;北京&#34;</span><span style="color:#f92672">})</span>;  <span style="color:#75715e"># Insert a single record</span>
</span></span><span style="display:flex;"><span>db.student.insertMany<span style="color:#f92672">([{</span>name:<span style="color:#e6db74">&#34;张三&#34;</span>,city:<span style="color:#e6db74">&#34;北京&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span>name:<span style="color:#e6db74">&#34;李四&#34;</span>,gender:<span style="color:#e6db74">&#34;女&#34;</span><span style="color:#f92672">}])</span>;  <span style="color:#75715e"># Insert multiple records</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db.student.find<span style="color:#f92672">({</span>name:<span style="color:#e6db74">&#34;张三&#34;</span><span style="color:#f92672">})</span>;  <span style="color:#75715e"># Find records that match the condition</span>
</span></span><span style="display:flex;"><span>db.student.find<span style="color:#f92672">({})</span>;  <span style="color:#75715e"># View all records in the collection</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db.student.updateOne<span style="color:#f92672">({</span>name:<span style="color:#e6db74">&#34;张三&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span>$set:<span style="color:#f92672">{</span>gender:<span style="color:#e6db74">&#34;女&#34;</span><span style="color:#f92672">}})</span>;  <span style="color:#75715e"># Update a single record</span>
</span></span><span style="display:flex;"><span>db.student.updateMany<span style="color:#f92672">({</span>name:<span style="color:#e6db74">&#34;张三&#34;</span><span style="color:#f92672">}</span>,<span style="color:#f92672">{</span>$set:<span style="color:#f92672">{</span>gender:<span style="color:#e6db74">&#34;女&#34;</span><span style="color:#f92672">}})</span>;  <span style="color:#75715e"># Update all records that match the condition</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db.student.deleteOne<span style="color:#f92672">({</span>name:<span style="color:#e6db74">&#34;张三&#34;</span><span style="color:#f92672">})</span>;  db.student.deleteMany<span style="color:#f92672">({</span>name:<span style="color:#e6db74">&#34;张三&#34;</span><span style="color:#f92672">})</span>;  <span style="color:#75715e"># Delete records</span>
</span></span><span style="display:flex;"><span>db.student.drop<span style="color:#f92672">()</span>;  <span style="color:#75715e"># Drop the collection</span>
</span></span></code></pre></div><h2 id="3-using-mongo-with-go">3 Using Mongo with Go</h2>
<h3 id="connection">Connection</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">option</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">Client</span>().<span style="color:#a6e22e">ApplyURI</span>(<span style="color:#e6db74">&#34;mongodb://127.0.0.1:27017&#34;</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">SetConnectTimeout</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>). <span style="color:#75715e">// Connection timeout duration
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// AuthSource represents the Database
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">SetAuth</span>(<span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">Credential</span>{<span style="color:#a6e22e">Username</span>: <span style="color:#e6db74">&#34;tester&#34;</span>, <span style="color:#a6e22e">Password</span>: <span style="color:#e6db74">&#34;123456&#34;</span>, <span style="color:#a6e22e">AuthSource</span>: <span style="color:#e6db74">&#34;test&#34;</span>})
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">mongo</span>.<span style="color:#a6e22e">Connect</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">option</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">CheckError</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Ping</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#66d9ef">nil</span>) <span style="color:#75715e">// A successful ping indicates a successful connection, not just the absence of an error from Connect
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">CheckError</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Disconnect</span>(<span style="color:#a6e22e">ctx</span>) <span style="color:#75715e">// Release the connection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h3 id="crud-operations">CRUD Operations</h3>
<p>See the code repository for examples.</p>
]]></content>
        </item>
        
        <item>
            <title>Be Careful When Choosing House</title>
            <link>https://Greenery-S.github.io/posts/life/singapore/be-careful-when-choosing-house/</link>
            <pubDate>Wed, 22 May 2024 00:43:27 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/life/singapore/be-careful-when-choosing-house/</guid>
            <description>Be Careful When Choosing a Place to Stay in Singapore When you come to Singapore, be careful when choosing a place to stay.
What is a poor person&amp;rsquo;s house? I refer to those who rent out a room in their own residence.
These landlords usually have significant financial pressures. On the one hand, they bought an HDB flat but need to rent out a room to help with their mortgage payments; on the other hand, they may be very picky about tenants, leading to conflicts and an atmosphere that feels more like a student dormitory than a home.</description>
            <content type="html"><![CDATA[<h1 id="be-careful-when-choosing-a-place-to-stay-in-singapore">Be Careful When Choosing a Place to Stay in Singapore</h1>
<p>When you come to Singapore, be careful when choosing a place to stay.</p>
<p>What is a poor person&rsquo;s house? I refer to those who rent out a room in their own residence.</p>
<p>These landlords usually have significant financial pressures. On the one hand, they bought an HDB flat but need to rent out a room to help with their mortgage payments; on the other hand, they may be very picky about tenants, leading to conflicts and an atmosphere that feels more like a student dormitory than a home.</p>
<p>Let me first talk about the normal renting process: viewing the house, paying the deposit, moving in, paying monthly rent, moving out, inspection, and returning the deposit. As long as the room is in the same condition when you move out as when you moved in, the deposit should not be deducted. It’s like &ldquo;eventual consistency&rdquo; in computing: as long as the final state of the room is okay, everything is fine. My experience with the popular Interlace Place condo was like this; the landlord or agent wouldn’t interfere with your normal life.</p>
<p>However, living in a &ldquo;poor person&rsquo;s house&rdquo; can be different. The landlord may frequently check your room, suspecting you of causing damage, and sometimes even invading your privacy.</p>
<p>Even more troubling is that sometimes landlords may ask for rent in advance for various reasons. For example, one landlord I had would ask for rent 15 to 23 days early every month, citing reasons like &ldquo;school fees,&rdquo; &ldquo;medical bills,&rdquo; or &ldquo;hosting a banquet.&rdquo; These requests became a monthly occurrence, hoping for understanding and help.</p>
<p>As a programmer, I value agreements and contracts, so I was not swayed by these emotional requests. I aimed to balance supporting the landlord while protecting my own interests, often refusing to pay rent in advance.</p>
<p>For the last two months, I was very lenient with the landlord’s family. They frequently asked for partial rent payments in advance, and I generally agreed. Additionally, I was out of the room 60% of the time each week, either visiting friends or taking care of my sister. Eventually, during my exam period, I was away for an entire month. When I returned, I found they had taken advance rent payments as a given, showing no respect for my boundaries. I immediately refused their request that month and communicated my stance through the agent, hoping they would understand.</p>
<p>Yesterday, with 10 days left until rent was due, the landlord asked for $100 again, but this time their tone was very pleading. I felt it was enough, so I gave them the money, and they were very grateful.</p>
<p>But I was exhausted. I don&rsquo;t enjoy manipulating people, and this place was indeed unsuitable for long-term rental. I contacted a monthly hotel rental service and decided to stay in a hotel for a month. When I discussed this with the landlord, I knew my deposit might not be fully returned, so I offered to accept only 50% of it back. However, they were in such financial difficulty that they begged me to stay another month and apply the deposit to that month&rsquo;s rent. Knowing I might incur some loss, I accepted as it seemed the only way for them to repay me.</p>
<p>Many people in Singapore face tough living conditions, especially those with financial difficulties. We can&rsquo;t change everyone&rsquo;s circumstances, but we can choose suitable living arrangements to avoid unnecessary troubles. I hope everyone can find a living situation that suits them.</p>
]]></content>
        </item>
        
        <item>
            <title>Introduction to Redis</title>
            <link>https://Greenery-S.github.io/posts/go/database/introduction-to-redis/</link>
            <pubDate>Sun, 19 May 2024 22:11:16 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/database/introduction-to-redis/</guid>
            <description>Redis Code: https://github.com/Greenery-S/go-database/tree/master/redis
1 Introduction Redis is an in-memory data storage system. Since it is based on memory, it is fast, being 10 to 100 times faster than MySQL. To prevent data loss, data is periodically persisted to disk. Redis is deployed separately from the business application, so it can serve as a distributed cache. It supports a rich variety of data types: strings, hashes, lists, sets, and sorted sets. It supports the publish/subscribe model, where publishers send messages to specified channels, and subscribers can receive and process these messages.</description>
            <content type="html"><![CDATA[<h1 id="redis">Redis</h1>
<blockquote>
<p>Code: <a href="https://github.com/Greenery-S/go-database/tree/master/redis">https://github.com/Greenery-S/go-database/tree/master/redis</a></p>
</blockquote>
<h2 id="1-introduction">1 Introduction</h2>
<ul>
<li>Redis is an in-memory data storage system.</li>
<li>Since it is based on memory, it is fast, being 10 to 100 times faster than MySQL.</li>
<li>To prevent data loss, data is periodically persisted to disk.</li>
<li>Redis is deployed separately from the business application, so it can serve as a distributed cache.</li>
<li>It supports a rich variety of data types: strings, hashes, lists, sets, and sorted sets.</li>
<li>It supports the publish/subscribe model, where publishers send messages to specified channels, and subscribers can receive and process these messages. This model is commonly used in real-time communication, event-driven systems, and message queues.</li>
<li>Redis transactions are not recommended as they are considered too limited.</li>
</ul>
<h2 id="2-publishsubscribe-model">2 Publish/Subscribe Model</h2>
<ol>
<li>Messages in the channel are not received before the subscriber starts.</li>
<li>Broadcast effect.</li>
</ol>

    <img src="/images/introduction-to-redis-pubsub.png"  alt="pubsub"  class="center"  style="border-radius: 20px; width: 100%;"  />


<h2 id="3-distributed-lock">3 Distributed Lock</h2>
<ol>
<li><code>SetNX(ctx context.Context, key string, value interface{}, expiration time.Duration) *BoolCmd</code></li>
<li>SetNX returns true and writes the key with an expiration time if the key does not exist.</li>
</ol>

    <img src="/images/introduction-to-redis-distributed-key.png"  alt="distributed-key"  class="center"  style="border-radius: 20px; width: 100%;"  />


<p>Example code for iPhone flash sale:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TryLock</span>(<span style="color:#a6e22e">rc</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">redis</span>.<span style="color:#a6e22e">Client</span>, <span style="color:#a6e22e">key</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">expire</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>) <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">cmd</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">rc</span>.<span style="color:#a6e22e">SetNX</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#a6e22e">key</span>, <span style="color:#e6db74">&#34;anything is ok&#34;</span>, <span style="color:#a6e22e">expire</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">cmd</span>.<span style="color:#a6e22e">Err</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cmd</span>.<span style="color:#a6e22e">Val</span>()
</span></span><span style="display:flex;"><span>	} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ReleaseLock</span>(<span style="color:#a6e22e">rc</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">redis</span>.<span style="color:#a6e22e">Client</span>, <span style="color:#a6e22e">key</span> <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">rc</span>.<span style="color:#a6e22e">Del</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#a6e22e">key</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LockRace2</span>(<span style="color:#a6e22e">client</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">redis</span>.<span style="color:#a6e22e">Client</span>, <span style="color:#a6e22e">storage</span> <span style="color:#66d9ef">int</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">keyLock</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;lock&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">keyStorage</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;store&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#a6e22e">keyStorage</span>, <span style="color:#a6e22e">storage</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">ReleaseLock</span>(<span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">keyLock</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Del</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#a6e22e">keyStorage</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">P</span> = <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">wg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">WaitGroup</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">wg</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#a6e22e">P</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">start</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">P</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">i</span> <span style="color:#66d9ef">int</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">wg</span>.<span style="color:#a6e22e">Done</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>(<span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Intn</span>(<span style="color:#ae81ff">100</span>)) <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Millisecond</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">TryLock</span>(<span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">keyLock</span>, <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">v</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">IncrBy</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#a6e22e">keyStorage</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">Val</span>(); <span style="color:#a6e22e">v</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;%d gets the No.%d iPhone! Use %v!\n&#34;</span>, <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">v</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>().<span style="color:#a6e22e">Sub</span>(<span style="color:#a6e22e">start</span>))
</span></span><span style="display:flex;"><span>				}
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">ReleaseLock</span>(<span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">keyLock</span>)
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}(<span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">wg</span>.<span style="color:#a6e22e">Wait</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="4-memory-eviction-mechanism">4 Memory Eviction Mechanism</h2>
<ol>
<li>LRU (Least Recently Used): Based on a linked list structure, elements in the list are arranged in the order of operations. The most recently operated keys are moved to the head of the list. When memory eviction is needed, the elements at the tail of the list are deleted.</li>
<li>LFU (Least Frequently Used): The basic assumption is that data accessed frequently in the past will also be accessed more frequently in the future, so the keys with the lowest usage frequency in the past are evicted. Redis uses a complex but efficient method to approximate LFU.</li>
<li>LFU is more reasonable than LRU but more complex to implement.</li>
</ol>

    <img src="/images/introduction-to-redis-memory.png"  alt="memory"  class="center"  style="border-radius: 20px; width: 100%;"  />


<h2 id="5-common-application-scenarios">5 Common Application Scenarios</h2>
<ul>
<li><strong>General Principle:</strong> Redis is an order of magnitude faster than MySQL but less reliable. It is suitable for storing data that requires high-frequency reads and writes, has a short lifecycle, and is not critically important to users.</li>
<li><strong>Counter:</strong> <code>Incr(ctx context.Context, key string)</code> increments the counter for the corresponding key, such as video views or inventory in a flash sale scenario. <code>INCRBY</code> can increment by any value, including negative numbers.</li>
<li><strong>Cache:</strong> Frequently accessed MySQL data can be stored in Redis, with keys corresponding to IDs and values as JSON strings. This reduces MySQL load and improves API response speed.</li>
<li><strong>Session Cache:</strong> Session IDs are used to mark successful user logins. Logins and subsequent operations may hit different servers, so session IDs need to be stored in distributed cache. Search/recommendation result lists are stored in cache and read from cache when paging.</li>
<li><strong>Distributed Lock:</strong> In a distributed system, scheduled tasks only need to be executed by one server. Whoever acquires the lock executes the task and releases the lock before the next cycle.</li>
<li><strong>Publish/Subscribe Function:</strong> Redis can be used for small-scale event notifications, while Kafka is more suitable for large-scale message passing.</li>
</ul>
]]></content>
        </item>
        
        <item>
            <title>ORM Realized by Reflect</title>
            <link>https://Greenery-S.github.io/posts/go/database/orm-realized-by-reflect/</link>
            <pubDate>Sun, 19 May 2024 21:50:59 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/database/orm-realized-by-reflect/</guid>
            <description>Core Technology of ORM—Reflection Tutorial, Reflection Guide: https://zhuanlan.zhihu.com/p/411313885
code: https://github.com/Greenery-S/go-database/tree/master/orm
1 Reflection What is Reflection
Reflection is the ability to inspect and modify an object’s type information and memory structure, update variables, and call methods during runtime (not compile time). When to Use Reflection
When a function’s parameter type is interface{}, and you need to determine the original type at runtime to handle different types accordingly. For example, json.Marshal(v interface{}). When you need to dynamically decide which function to call at runtime based on certain conditions, such as executing the appropriate operator function based on a configuration file.</description>
            <content type="html"><![CDATA[<h1 id="core-technology-of-ormreflection">Core Technology of ORM—Reflection</h1>
<blockquote>
<p>Tutorial, Reflection Guide: <a href="https://zhuanlan.zhihu.com/p/411313885">https://zhuanlan.zhihu.com/p/411313885</a></p>
<p>code: <a href="https://github.com/Greenery-S/go-database/tree/master/orm">https://github.com/Greenery-S/go-database/tree/master/orm</a></p>
</blockquote>
<h2 id="1-reflection">1 Reflection</h2>
<p><strong>What is Reflection</strong></p>
<ul>
<li>Reflection is the ability to inspect and modify an object’s type information and memory structure, update variables, and call methods during <strong>runtime</strong> (not compile time).</li>
</ul>
<p><strong>When to Use Reflection</strong></p>
<ul>
<li>When a function’s parameter type is <code>interface{}</code>, and you need to determine the original type at runtime to handle different types accordingly. For example, <code>json.Marshal(v interface{})</code>.</li>
<li>When you need to dynamically decide which function to call at runtime based on certain conditions, such as executing the appropriate operator function based on a configuration file.</li>
<li>It is recommended to use reflection during the initialization phase. Avoid using it frequently in API calls due to performance concerns.</li>
</ul>
<h2 id="2-usage-examples">2 Usage Examples</h2>

    <img src="/images/orm-realized-by-reflect-example.png"  alt="show-table"  class="center"  style="border-radius: 10px; width: 80%;"  />


<h2 id="3-drawbacks-of-reflection">3 Drawbacks of Reflection</h2>
<ol>
<li>Code readability and maintainability are poor.</li>
<li>Type errors cannot be detected during compilation, making comprehensive testing challenging. Some bugs may only be discovered after prolonged runtime in production, potentially causing severe consequences.</li>
<li>Reflection performance is poor, typically one to two orders of magnitude slower than regular code. Avoid using reflection in performance-critical or frequently called code blocks.</li>
</ol>
<h2 id="4-basic-data-types-of-reflection">4 Basic Data Types of Reflection</h2>

    <img src="/images/orm-realized-by-reflect-data-type.png"  alt="show-table"  class="center"  style="border-radius: 10px; width: 80%;"  />


<p><strong>reflect.Type</strong> – Retrieve type-related information using <code>reflect.Type</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Type</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">MethodByName</span>(<span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">Method</span>, <span style="color:#66d9ef">bool</span>) <span style="color:#75715e">// Retrieve method by name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">Name</span>() <span style="color:#66d9ef">string</span>   <span style="color:#75715e">// Get the struct name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">PkgPath</span>() <span style="color:#66d9ef">string</span> <span style="color:#75715e">// Package path
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">Size</span>() <span style="color:#66d9ef">uintptr</span>  <span style="color:#75715e">// Memory size
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">Kind</span>() <span style="color:#a6e22e">Kind</span>  <span style="color:#75715e">// Data type
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">Implements</span>(<span style="color:#a6e22e">u</span> <span style="color:#a6e22e">Type</span>) <span style="color:#66d9ef">bool</span>  <span style="color:#75715e">// Check if it implements an interface
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">Field</span>(<span style="color:#a6e22e">i</span> <span style="color:#66d9ef">int</span>) <span style="color:#a6e22e">StructField</span>  <span style="color:#75715e">// Retrieve the i-th field
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">FieldByIndex</span>(<span style="color:#a6e22e">index</span> []<span style="color:#66d9ef">int</span>) <span style="color:#a6e22e">StructField</span>  <span style="color:#75715e">// Retrieve nested field by index path
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">FieldByName</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">StructField</span>, <span style="color:#66d9ef">bool</span>)  <span style="color:#75715e">// Retrieve field by name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">Len</span>() <span style="color:#66d9ef">int</span>  <span style="color:#75715e">// Container length
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">NumIn</span>() <span style="color:#66d9ef">int</span>  <span style="color:#75715e">// Number of input parameters
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">NumOut</span>() <span style="color:#66d9ef">int</span>  <span style="color:#75715e">// Number of return parameters
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p><strong>reflect.Value</strong> – Retrieve and modify values within the original data type using <code>reflect.Value</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Value</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// The type represented by this value
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">typ</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">rtype</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Pointer to the original data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ptr</span> <span style="color:#a6e22e">unsafe</span>.<span style="color:#a6e22e">Pointer</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="5-retrieving-field-information">5 Retrieving Field Information</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">typeUser</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">TypeOf</span>(<span style="color:#a6e22e">User</span>{})
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">typeUser</span>.<span style="color:#a6e22e">NumField</span>(); <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> { <span style="color:#75715e">// Number of fields
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">field</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">typeUser</span>.<span style="color:#a6e22e">Field</span>(<span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;%s offset %d anonymous %t type %s exported %t json tag %s\n&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">field</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#75715e">// Field name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">field</span>.<span style="color:#a6e22e">Offset</span>, <span style="color:#75715e">// Memory offset from the struct&#39;s start address; string type occupies 16 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">field</span>.<span style="color:#a6e22e">Anonymous</span>, <span style="color:#75715e">// Is it an anonymous field
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">field</span>.<span style="color:#a6e22e">Type</span>, <span style="color:#75715e">// Data type, of type reflect.Type
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">field</span>.<span style="color:#a6e22e">IsExported</span>(), <span style="color:#75715e">// Is it visible outside the package (i.e., starts with an uppercase letter)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">field</span>.<span style="color:#a6e22e">Tag</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;json&#34;</span>)) <span style="color:#75715e">// Retrieve the tag defined after the field in ``
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h2 id="6-principles-of-orm-implementation">6 Principles of ORM Implementation</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Id</span>         <span style="color:#66d9ef">int</span>    <span style="color:#e6db74">`gorm:&#34;column:id;primaryKey&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Gender</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;column:sex&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Name</span>       <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`gorm:&#34;-&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">FamilyName</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol>
<li>Ignore fields marked with <code>gorm:&quot;-&quot;</code></li>
<li>Retrieve the content after <code>gorm</code> from <code>field.Tag.Get(&quot;gorm&quot;)</code></li>
<li>Remove the prefix <code>&quot;column:&quot;</code></li>
<li>Split the string by <code>;</code> and take the first part</li>
<li>Fields without an explicit <code>gorm</code> tag will be converted to snake case, corresponding to the MySQL table column</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetGormFields</span>(<span style="color:#a6e22e">stc</span> <span style="color:#66d9ef">interface</span>{}) []<span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">value</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">ValueOf</span>(<span style="color:#a6e22e">stc</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">typ</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">Type</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">columns</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">string</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">NumField</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">NumField</span>(); <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fieldType</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">typ</span>.<span style="color:#a6e22e">Field</span>(<span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Skip fields not mapped to ORM
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">fieldType</span>.<span style="color:#a6e22e">Tag</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;gorm&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;-&#34;</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Convert camel case to snake case if there is no gorm tag
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">name</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">Camel2Snake</span>(<span style="color:#a6e22e">fieldType</span>.<span style="color:#a6e22e">Name</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">fieldType</span>.<span style="color:#a6e22e">Tag</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;gorm&#34;</span>)) &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">content</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fieldType</span>.<span style="color:#a6e22e">Tag</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;gorm&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">HasPrefix</span>(<span style="color:#a6e22e">content</span>, <span style="color:#e6db74">&#34;column:&#34;</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">content</span> = <span style="color:#a6e22e">content</span>[<span style="color:#ae81ff">7</span>:]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pos</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Index</span>(<span style="color:#a6e22e">content</span>, <span style="color:#e6db74">&#34;;&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pos</span> &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">name</span> = <span style="color:#a6e22e">content</span>[:<span style="color:#a6e22e">pos</span>]
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pos</span> &lt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">name</span> = <span style="color:#a6e22e">content</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">columns</span> = append(<span style="color:#a6e22e">columns</span>, <span style="color:#a6e22e">name</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">columns</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>]]></content>
        </item>
        
        <item>
            <title>MySQL Optimization</title>
            <link>https://Greenery-S.github.io/posts/go/database/mysql-optimization/</link>
            <pubDate>Sun, 19 May 2024 21:16:35 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/database/mysql-optimization/</guid>
            <description>MySQL Performance Tuning code: https://github.com/Greenery-S/go-database/tree/master/mysql
1 Practical Recommendations Always use lowercase when writing SQL.
Check if a table already exists before creating it using if not exists.
Add comment to all columns and tables.
Use char for short strings to benefit from fixed length and memory alignment, which improves read/write performance. varchar fields may cause memory fragmentation with frequent modifications.
Use shorter data types whenever possible, e.g., tinyint vs int, float vs double, date vs datetime.</description>
            <content type="html"><![CDATA[<h1 id="mysql-performance-tuning">MySQL Performance Tuning</h1>
<blockquote>
<p>code: <a href="https://github.com/Greenery-S/go-database/tree/master/mysql">https://github.com/Greenery-S/go-database/tree/master/mysql</a></p>
</blockquote>
<h3 id="1-practical-recommendations">1 Practical Recommendations</h3>
<ul>
<li>
<p>Always use lowercase when writing SQL.</p>
</li>
<li>
<p>Check if a table already exists before creating it using <code>if not exists</code>.</p>
</li>
<li>
<p>Add <code>comment</code> to all columns and tables.</p>
</li>
<li>
<p>Use <code>char</code> for short strings to benefit from fixed length and memory alignment, which improves read/write performance. <code>varchar</code> fields may cause memory fragmentation with frequent modifications.</p>
</li>
<li>
<p>Use shorter data types whenever possible, e.g., <code>tinyint</code> vs <code>int</code>, <code>float</code> vs <code>double</code>, <code>date</code> vs <code>datetime</code>.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exists</span> <span style="color:#f92672">`</span>student<span style="color:#f92672">`</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>id<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">11</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> AUTO_INCREMENT <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;Primary key auto-increment id&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>name<span style="color:#f92672">`</span> char(<span style="color:#ae81ff">10</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;Name&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>province<span style="color:#f92672">`</span> char(<span style="color:#ae81ff">6</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;Province&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>city<span style="color:#f92672">`</span> char(<span style="color:#ae81ff">10</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;City&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>addr<span style="color:#f92672">`</span> varchar(<span style="color:#ae81ff">100</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;Address&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>score<span style="color:#f92672">`</span> float <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#e6db74">&#39;0&#39;</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;Exam score&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>enrollment<span style="color:#f92672">`</span> date <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">COMMENT</span> <span style="color:#e6db74">&#39;Enrollment date&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (<span style="color:#f92672">`</span>id<span style="color:#f92672">`</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">UNIQUE</span> <span style="color:#66d9ef">KEY</span> <span style="color:#f92672">`</span>idx_name<span style="color:#f92672">`</span> (<span style="color:#f92672">`</span>name<span style="color:#f92672">`</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">KEY</span> <span style="color:#f92672">`</span>idx_location<span style="color:#f92672">`</span> (<span style="color:#f92672">`</span>province<span style="color:#f92672">`</span>,<span style="color:#f92672">`</span>city<span style="color:#f92672">`</span>)
</span></span><span style="display:flex;"><span>) ENGINE<span style="color:#f92672">=</span>InnoDB AUTO_INCREMENT<span style="color:#f92672">=</span><span style="color:#ae81ff">100020</span> <span style="color:#66d9ef">DEFAULT</span> CHARSET<span style="color:#f92672">=</span>utf8 <span style="color:#66d9ef">COMMENT</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Student basic information&#39;</span>;
</span></span></code></pre></div><h2 id="2-null">2 null</h2>
<ul>
<li>
<p><code>default null</code> differs from <code>default ''</code> and <code>default 0</code>.</p>
</li>
<li>
<p><code>is null</code>, <code>is not null</code> differ from <code>!= ''</code>, <code>!= 0</code>.</p>
</li>
<li>
<p>Set fields to <code>not null</code> whenever possible:</p>
<ul>
<li>Some DB indexes do not allow null values.</li>
<li>Statistics on columns with null values may be inaccurate.</li>
<li>Null values can sometimes severely degrade system performance.</li>
</ul>
</li>
</ul>
<h2 id="3-avoiding-slow-queries-eg-1s">3 Avoiding Slow Queries (e.g., &gt;1s)</h2>
<ul>
<li>Most slow queries result from improper index usage.</li>
<li>Avoid creating too many indexes, as it slows down writes.</li>
<li>Use the default InnoDB engine in most cases, rather than MyISAM.</li>
<li>Avoid <code>select *</code>, only select the columns you need.</li>
<li>Use <code>in</code> instead of <code>or</code> when possible, as <code>in</code> is more efficient.</li>
<li>Limit the number of elements in <code>in</code> to 300-500.</li>
<li>Avoid model queries like <code>like</code>, as they cannot use indexes effectively.</li>
<li>Use <code>limit 1</code> if you are sure the result is a single row, to avoid full table scans.</li>
<li><code>limit m,n</code> retrieves the first m+n rows but only returns the last n rows. Use <code>id&gt;x</code> to replace this pagination method.</li>
<li>Batch operations in a single SQL statement or as a single transaction to reduce contention on shared resources.</li>
<li>Avoid large transactions; use small transactions to reduce lock waiting and contention.</li>
<li>Limit the number of rows queried or updated at once to around 1000.</li>
<li>Avoid join operations; handle join logic in application code.</li>
<li>Do not use MySQL built-in functions as they do not utilize query caching; handle complex logic in your code.</li>
</ul>
<h2 id="4-b-tree">4 B+ Tree</h2>
<ol>
<li>B stands for Balance. In an m-ary tree, each node has up to m data items and at least m/2 data items (except the root node).</li>
<li>Leaf nodes store all data and are linked for sequential access.</li>
<li>Each node is designed as a multiple of memory pages (4K). In MySQL, m=1200, so the first two levels of the tree are stored in memory.</li>
</ol>

    <img src="/images/mysql-optimization-bplustree.png"  alt="b&#43;tree"  class="center"  style="border-radius: 20px; width: 300px;"  />


<h2 id="5-indexes">5 Indexes</h2>
<ul>
<li>MySQL indexes use B+ trees by default.
<ul>
<li>Why not hashtable? 1) Not all data can be loaded into memory; 2) Not suitable for range queries.</li>
</ul>
</li>
<li>The primary key automatically gets indexed. The B+ tree built by the primary key contains data for all columns, whereas a normal index’s B+ tree stores only the primary key, requiring another lookup (back to the table).</li>
<li>The prefix of a composite index also functions as an index.</li>
<li>Use <code>explain</code> before SQL statements to check index usage.</li>
<li>If MySQL does not choose the optimal index plan, use <code>force index (index_name)</code> before <code>where</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">show</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> student;
</span></span></code></pre></div>
    <img src="/images/mysql-optimization-show-table.png"  alt="show-table"  class="center"  style="border-radius: 10px; width: 100%;"  />


<h2 id="6-covering-indexes">6 Covering Indexes</h2>

    <img src="/images/mysql-optimization-cover-index.png"  alt="cover-index"  class="center"  style="border-radius: 10px; width: 300;"  />


<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> city <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">where</span> name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;张三&#39;</span> <span style="color:#66d9ef">and</span> province<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;北京&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">explain</span> <span style="color:#66d9ef">select</span> city <span style="color:#66d9ef">from</span> student <span style="color:#66d9ef">force</span> <span style="color:#66d9ef">index</span> (idx_location) <span style="color:#66d9ef">where</span> name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;张三&#39;</span> <span style="color:#66d9ef">and</span> province<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;北京&#39;</span>;
</span></span></code></pre></div>
    <img src="/images/mysql-optimization-explain-select.png"  alt="cover-index"  class="center"  style="border-radius: 10px; width: 300;"  />


<ul>
<li>The first query needs to go back to the table.</li>
<li>The second SQL query only needs to query the <code>city</code>, and it hits the composite index (<code>province</code>, <code>city</code>), so it does not need to go back to the table. This is a covering index (hits a non-primary key index without needing to go back to the table).</li>
<li>The covering index will show &ldquo;Using index&rdquo; in the Extra field of the <code>explain</code> output.</li>
</ul>
<h2 id="7-sql-injection-attacks">7 SQL Injection Attacks</h2>
<p><strong>CASE 1</strong></p>
<ul>
<li><code>sql = &quot;select username, password from user where username='&quot; + username + &quot;' and password='&quot; + password + &quot;'&quot;;</code></li>
<li>Variables <code>username</code> and <code>password</code> come from the frontend input. If a user inputs <code>username</code> as lily and <code>password</code> as <code>aaa' or '1'='1</code>, the complete SQL would be <code>select username, password from user where username='lily' and password='aaa' or '1'='1'</code>.</li>
<li>This returns all records in the table. If the record count is greater than 0, login is allowed, so lily’s account is compromised.</li>
</ul>
<p><strong>CASE 2</strong></p>
<ul>
<li><code>sql=&quot;insert into student (name) values ('&quot; + username + &quot; ') &quot;;</code></li>
<li>The variable <code>username</code> comes from the frontend input. If the user inputs <code>username</code> as <code>lily'); drop table student;--</code>, the complete SQL would be <code>insert into student (name) values ('lily'); drop table student;--')</code>.</li>
<li>The comment <code>--</code> ignores the trailing <code>')</code>, deleting the entire table.</li>
</ul>
<h3 id="prevention-methods">Prevention Methods</h3>
<p><strong>Overall</strong></p>
<ul>
<li>Validate frontend inputs with regex and length checks.</li>
<li>Escape or encode special characters (e.g., &lt;&gt;&amp;*; &lsquo;&quot; etc.). Go’s <code>text/template</code> package function <code>HTMLEscapeString</code> can escape strings.</li>
<li>Avoid embedding user inputs directly in SQL statements; use <strong>parameterized queries</strong> like <code>Prepare</code>, <code>Query</code>, <code>Exec(query string, args ...interface{})</code>.</li>
<li>Use professional SQL injection detection tools such as sqlmap and SQLninja.</li>
<li><strong>Avoid displaying SQL error messages</strong> to prevent attackers from exploiting them.</li>
<li>No single method can prevent all SQL injection attacks; use a combination of methods.</li>
</ul>
<p><strong>Stmt</strong></p>
<ul>
<li>
<p>Define an SQL template: <code>stmt, err := db.Prepare(&quot;update student set score=score+? where city=?&quot;)</code>.</p>
</li>
<li>
<p>Use the template multiple times:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">stmt</span>.<span style="color:#a6e22e">Exec</span>(<span style="color:#ae81ff">10</span>, <span style="color:#e6db74">&#34;Shanghai&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">stmt</span>.<span style="color:#a6e22e">Exec</span>(<span style="color:#ae81ff">9</span>, <span style="color:#e6db74">&#34;Shenzhen&#34;</span>);
</span></span></code></pre></div></li>
<li>
<p>Avoid SQL concatenation (vulnerable to SQL injection and cannot leverage compilation optimization): <code>db.Where(fmt.Sprintf(&quot;merchant_id = %s&quot;, merchantId))</code>.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">exists</span> <span style="color:#f92672">`</span>login<span style="color:#f92672">`</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>username<span style="color:#f92672">`</span> varchar(<span style="color:#ae81ff">100</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">`</span>password<span style="color:#f92672">`</span> varchar(<span style="color:#ae81ff">100</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span>) ENGINE<span style="color:#f92672">=</span>InnoDB <span style="color:#66d9ef">DEFAULT</span> CHARSET<span style="color:#f92672">=</span>latin1;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Returns true if login is successful. Vulnerable to SQL injection.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoginUnsafe</span>(<span style="color:#a6e22e">db</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">passwd</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cnt</span> <span style="color:#66d9ef">int64</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Table</span>(<span style="color:#e6db74">&#34;login&#34;</span>).<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;*&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username=&#39;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39; and password=&#39;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">passwd</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;&#34;</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cnt</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cnt</span> &gt; <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Returns true if login is successful. Protected against SQL injection.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoginSafe</span>(<span style="color:#a6e22e">db</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">passwd</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cnt</span> <span style="color:#66d9ef">int64</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Table</span>(<span style="color:#e6db74">&#34;login&#34;</span>).<span style="color:#a6e22e">Select</span>(<span style="color:#e6db74">&#34;*&#34;</span>).<span style="color:#a6e22e">Where</span>(<span style="color:#e6db74">&#34;username=? and password=?&#34;</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">passwd</span>).<span style="color:#a6e22e">Count</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cnt</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cnt</span> &gt; <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestLoginUnsafe</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">db</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">mysql</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">dsn</span>), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Config</span>{<span style="color:#a6e22e">PrepareStmt</span>: <span style="color:#66d9ef">true</span>}); <span style="color:#75715e">// Enforce PrepareStmt
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    panic(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">LoginUnsafe</span>(<span style="color:#a6e22e">db</span>, <span style="color:#e6db74">&#34;tom&#34;</span>, <span style="color:#e6db74">&#34;123456&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">LoginUnsafe</span>(<span style="color:#a6e22e">db</span>, <span style="color:#e6db74">&#34;tom&#34;</span>, <span style="color:#e6db74">&#34;456789&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// select * from login
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">where</span> <span style="color:#a6e22e">username</span>=<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">tom</span><span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">password</span>=<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">456789</span><span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#a6e22e">or</span> <span style="color:#e6db74">&#39;1&#39;</span>=<span style="color:#e6db74">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">LoginUnsafe</span>(<span style="color:#a6e22e">db</span>, <span style="color:#e6db74">&#34;tom&#34;</span>, <span style="color:#e6db74">&#34;456789&#39; or &#39;1&#39;=&#39;1&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestLoginSafe</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">db</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">mysql</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">dsn</span>), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Config</span>{<span style="color:#a6e22e">PrepareStmt</span>: <span style="color:#66d9ef">true</span>}); <span style="color:#75715e">// Enforce PrepareStmt
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    panic(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">LoginSafe</span>(<span style="color:#a6e22e">db</span>, <span style="color:#e6db74">&#34;tom&#34;</span>, <span style="color:#e6db74">&#34;123456&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">LoginSafe</span>(<span style="color:#a6e22e">db</span>, <span style="color:#e6db74">&#34;tom&#34;</span>, <span style="color:#e6db74">&#34;456789&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">LoginSafe</span>(<span style="color:#a6e22e">db</span>, <span style="color:#e6db74">&#34;tom&#34;</span>, <span style="color:#e6db74">&#34;456789&#39; or &#39;1&#39;=&#39;1&#34;</span>) <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>SQL Precompilation</strong></p>
<ul>
<li>
<p>DB execution of SQL involves three steps:</p>
<ol>
<li>Lexical and semantic analysis.</li>
<li>SQL statement optimization and execution plan formulation.</li>
<li>Execution and return of results.</li>
</ol>
</li>
<li>
<p>SQL precompilation replaces user inputs with placeholders (<code>?</code>), precompiles the template SQL, and injects user inputs at runtime.</p>
</li>
<li>
<p>This prevents SQL injection and allows caching of precompiled SQL statements, avoiding repeated analysis and optimization.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkQueryWithoutPrepare</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">mysql</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">dsn</span>), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Config</span>{}); <span style="color:#75715e">// PrepareStmt not specified
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    panic(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">ResetTimer</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">N</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">LoginUnsafe</span>(<span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">passwd</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkQueryWithPrepare</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">mysql</span>.<span style="color:#a6e22e">Open</span>(<span style="color:#a6e22e">dsn</span>), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">Config</span>{<span style="color:#a6e22e">PrepareStmt</span>: <span style="color:#66d9ef">true</span>}); <span style="color:#75715e">// Enforce PrepareStmt
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    panic(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">ResetTimer</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">N</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">LoginUnsafe</span>(<span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">passwd</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; go test ./ -bench<span style="color:#f92672">=</span>^BenchmarkQueryWith -run<span style="color:#f92672">=</span>^$ -count<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> -benchmem
</span></span><span style="display:flex;"><span>goos: darwin
</span></span><span style="display:flex;"><span>goarch: arm64
</span></span><span style="display:flex;"><span>pkg: dqq/database/mysql
</span></span><span style="display:flex;"><span>BenchmarkQueryWithoutPrepare-10             <span style="color:#ae81ff">7888</span>            <span style="color:#ae81ff">147138</span> ns/op            <span style="color:#ae81ff">3441</span> B/op         <span style="color:#ae81ff">54</span> allocs/op
</span></span><span style="display:flex;"><span>BenchmarkQueryWithPrepare-10                <span style="color:#ae81ff">8508</span>            <span style="color:#ae81ff">130443</span> ns/op            <span style="color:#ae81ff">3458</span> B/op         <span style="color:#ae81ff">55</span> allocs/op
</span></span><span style="display:flex;"><span>PASS
</span></span></code></pre></div><h2 id="8-pagination-queries">8 Pagination Queries</h2>
<ul>
<li><code>limit m,n</code> retrieves the first m+n rows but only returns the last n rows. Use <code>id&gt;x</code> to replace this pagination method.</li>
<li>Full table scan:
<ol>
<li>Directly selecting <code>* from table</code> is slow, violating the principle of not querying too many rows at once.</li>
<li>Pagination appears to query few rows, but it executes multiple full table scans.</li>
<li>Fix <code>page_size</code> and maintain the maximum queried <code>id (max_id)</code>. Query using <code>where id&gt;maxid limit page_size</code>, exiting the loop when the result is empty.</li>
</ol>
</li>
</ul>

    <img src="/images/mysql-optimization-pagenate.png"  alt="pagination"  class="center"  style="border-radius: 10px; width: 300;"  />


<h2 id="9-transactions">9 Transactions</h2>
<ul>
<li>Batch operations should be done in a single SQL statement; otherwise, bundle them in a transaction and commit once to reduce contention on shared resources.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">INSERT_COUNT</span> = <span style="color:#ae81ff">100000</span>;
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Insert one by one
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">InsertOneByOne</span>(<span style="color:#a6e22e">db</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">begin</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">INSERT_COUNT</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">student</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Student</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;Student&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">i</span>), <span style="color:#a6e22e">Province</span>: <span style="color:#e6db74">&#34;Beijing&#34;</span>, <span style="color:#a6e22e">City</span>: <span style="color:#e6db74">&#34;Beijing&#34;</span>, <span style="color:#a6e22e">Score</span>: <span style="color:#ae81ff">38</span>, <span style="color:#a6e22e">Enrollment</span>: <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">student</span>).<span style="color:#a6e22e">Error</span>; <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> { <span style="color:#75715e">// Note: pass the pointer of student
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;total&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">begin</span>));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Insert within a transaction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">InsertByTransaction1</span>(<span style="color:#a6e22e">db</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">begin</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Begin</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">INSERT_COUNT</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">student</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Student</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;Student&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">i</span>), <span style="color:#a6e22e">Province</span>: <span style="color:#e6db74">&#34;Beijing&#34;</span>, <span style="color:#a6e22e">City</span>: <span style="color:#e6db74">&#34;Beijing&#34;</span>, <span style="color:#a6e22e">Score</span>: <span style="color:#ae81ff">38</span>, <span style="color:#a6e22e">Enrollment</span>: <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tx</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">student</span>).<span style="color:#a6e22e">Error</span>; <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tx</span>.<span style="color:#a6e22e">Commit</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;total&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">begin</span>));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Insert multiple rows at once within a transaction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">InsertByTransaction2</span>(<span style="color:#a6e22e">db</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">gorm</span>.<span style="color:#a6e22e">DB</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">begin</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">Begin</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">BATCH</span> = <span style="color:#ae81ff">100</span>; <span style="color:#75715e">// Insert multiple rows in a single SQL statement
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">INSERT_COUNT</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">BATCH</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">students</span> <span style="color:#f92672">:=</span> make([]<span style="color:#a6e22e">Student</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">BATCH</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">j</span> &lt; <span style="color:#a6e22e">BATCH</span>; <span style="color:#a6e22e">j</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">student</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Student</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;Student&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">i</span><span style="color:#f92672">+</span><span style="color:#a6e22e">j</span>), <span style="color:#a6e22e">Province</span>: <span style="color:#e6db74">&#34;Beijing&#34;</span>, <span style="color:#a6e22e">City</span>: <span style="color:#e6db74">&#34;Beijing&#34;</span>, <span style="color:#a6e22e">Score</span>: <span style="color:#ae81ff">38</span>, <span style="color:#a6e22e">Enrollment</span>: <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()};
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">students</span> = append(<span style="color:#a6e22e">students</span>, <span style="color:#a6e22e">student</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tx</span>.<span style="color:#a6e22e">Create</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">students</span>).<span style="color:#a6e22e">Error</span>; <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tx</span>.<span style="color:#a6e22e">Commit</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;total&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">begin</span>));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#f92672">===</span> RUN   TestInsertOneByOne
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>total 1m55.652681166s
</span></span><span style="display:flex;"><span>--- PASS: TestInsertOneByOne <span style="color:#f92672">(</span>116.20s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===</span> RUN   TestInsertByTransaction1
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>total 27.29299825s
</span></span><span style="display:flex;"><span>--- PASS: TestInsertByTransaction1 <span style="color:#f92672">(</span>27.91s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===</span> RUN   TestInsertByTransaction2
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>total 3.226376333s
</span></span><span style="display:flex;"><span>--- PASS: TestInsertByTransaction2 <span style="color:#f92672">(</span>4.20s<span style="color:#f92672">)</span>
</span></span></code></pre></div>]]></content>
        </item>
        
        <item>
            <title>How to Maintain the Site</title>
            <link>https://Greenery-S.github.io/posts/hugo/site-building/how-to-maintain-the-site/</link>
            <pubDate>Sun, 19 May 2024 02:32:11 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/hugo/site-building/how-to-maintain-the-site/</guid>
            <description>How to Maintain a Blog with Hugo and GitHub GitHub Pages is an excellent platform for hosting blogs. It allows you to maintain your blog using Git, making it particularly suitable for programmers, as most of us are familiar with Git.
Hugo is a great static site generator that lets you create static websites using Markdown files. This method is ideal for programmers since most of us are comfortable with Markdown.</description>
            <content type="html"><![CDATA[<h1 id="how-to-maintain-a-blog-with-hugo-and-github">How to Maintain a Blog with Hugo and GitHub</h1>
<p><a href="https://pages.github.com/">GitHub Pages</a> is an excellent platform for hosting blogs. It allows you to maintain your blog using Git, making it particularly suitable for programmers, as most of us are familiar with Git.</p>
<p><a href="https://gohugo.io/">Hugo</a> is a great static site generator that lets you create static websites using Markdown files. This method is ideal for programmers since most of us are comfortable with Markdown.</p>
<p>This article will teach you how to maintain your blog using Hugo and GitHub.</p>
<h2 id="install-hugo-and-git">Install Hugo and Git</h2>
<p>First, you need to install Hugo and Git. You can install them using the following commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Install Hugo</span>
</span></span><span style="display:flex;"><span>brew install hugo
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Install Git</span>
</span></span><span style="display:flex;"><span>brew install git
</span></span></code></pre></div><h2 id="create-two-repositories-on-github">Create Two Repositories on GitHub</h2>
<p>You need to create two repositories on GitHub: one to store the source files of Hugo, and another to store the static website generated by Hugo.</p>
<p>The repository for storing the generated static website should be named <code>&lt;yourname.github.io&gt;</code>. This repository is public and is used to store your Hugo source files.</p>
<h2 id="initialize-the-website-project-locally">Initialize the Website Project Locally</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Initialize the Hugo project</span>
</span></span><span style="display:flex;"><span>hugo new site &lt;site-name&gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize the Git project</span>
</span></span><span style="display:flex;"><span>git init
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Add the remote repository</span>
</span></span><span style="display:flex;"><span>git remote add origin &lt;your-site-source-repo&gt;
</span></span></code></pre></div><h2 id="create-preview-and-edit-posts">Create, Preview, and Edit Posts</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Create a post</span>
</span></span><span style="display:flex;"><span>hugo new posts/my-first-post.md
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Preview the site</span>
</span></span><span style="display:flex;"><span>hugo server -D
</span></span></code></pre></div><h2 id="change-themes">Change Themes</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Download the theme</span>
</span></span><span style="display:flex;"><span>git submodule add &lt;theme-url&gt; themes/&lt;theme-name&gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Copy the configuration file</span>
</span></span><span style="display:flex;"><span>cp themes/&lt;theme-name&gt;/exampleSite/config.toml .
</span></span></code></pre></div><p>Configuration changes vary by theme, so refer to the theme&rsquo;s documentation. For example, if you&rsquo;re using the &lsquo;hello-friend-ng&rsquo; theme, it is recommended to:</p>
<ul>
<li>Place all posts in the <code>content/posts</code> directory.</li>
<li>Configure the <code>config.toml</code> file to modify the menu:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>[[<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;about&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;About&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;posts/about&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>[[<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;site-building&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;Site-building&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;categories/hugo-site-building/&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">5</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="publish-the-website-to-githubio">Publish the Website to GitHub.io</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Generate the static website</span>
</span></span><span style="display:flex;"><span>hugo
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Commit to GitHub</span>
</span></span><span style="display:flex;"><span>cd public
</span></span><span style="display:flex;"><span>git add .
</span></span><span style="display:flex;"><span>git commit -m <span style="color:#e6db74">&#34;add new post&#34;</span>
</span></span><span style="display:flex;"><span>git push origin master
</span></span></code></pre></div><p>You can then visit <code>https://&lt;yourname&gt;.github.io</code> to see your blog.</p>
<blockquote>
<p>Reference Links:</p>
<ul>
<li><a href="https://cuttontail.blog/blog/create-a-wesite-using-github-pages-and-hugo/">Tutorial</a></li>
</ul>
</blockquote>
]]></content>
        </item>
        
        <item>
            <title>About</title>
            <link>https://Greenery-S.github.io/posts/about/</link>
            <pubDate>Sun, 19 May 2024 01:10:01 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/about/</guid>
            <description>About This Site This site is a blog based on Hugo, mainly used to document my studies and life.
Hugo is a static site generator written in Go. It is incredibly fast and supports Markdown syntax. It uses Go templates, so its usage is quite similar to other generators like Helm.
About Me I am a soon-to-be graduate student. I am studying for a master&amp;rsquo;s degree in Computer Engineering at NUS.</description>
            <content type="html"><![CDATA[<h1 id="about-this-site">About This Site</h1>
<p>This site is a blog based on Hugo, mainly used to document my studies and life.</p>
<p>Hugo is a static site generator written in Go. It is incredibly fast and supports Markdown syntax. It uses Go templates, so its usage is quite similar to other generators like Helm.</p>
<h1 id="about-me">About Me</h1>
<p>I am a soon-to-be graduate student. I am studying for a master&rsquo;s degree in Computer Engineering at NUS. My undergraduate degree is in Computer Science and Technology from a 985 university, where I ranked quite high, but I still feel there is much to learn. I wanted to see the world, so I came to Singapore.</p>

    <img src="/images/author.jpg"  alt="Hello Friend"  class="center"  style="border-radius: 20px; width: 200px;"  />


<p>Here is my resume:</p>
<ul>
<li><a href="/cv/cven.pdf">Resume PDF</a></li>
</ul>
<h2 id="my-tech-stack">My Tech Stack</h2>
<h3 id="programming-languages">Programming Languages</h3>
<ul>
<li><strong>C/C++</strong>: Used during my undergraduate studies for coursework, but I am not proficient. Recently, I&rsquo;ve been reviewing it on learncpp.com.</li>
<li><strong>Python</strong>: I&rsquo;ve written some data processing, machine learning, deep learning, and reinforcement learning code with Python and worked independently on several research projects. I am fairly familiar with it, though I don&rsquo;t particularly like Python&rsquo;s syntax, as it is not ideal for building reliable projects.</li>
<li><strong>Go</strong>: The first production-level language I mastered. I use it to write backend services, tools, scripts, crawlers, etc. I quite like Go&rsquo;s syntax, concurrency model, standard library, and toolchain.</li>
<li><strong>Java</strong>: Learned object-oriented programming with Java during my undergraduate studies. Bought a course on how2j during my sophomore year but haven&rsquo;t gotten around to it. I believe I could learn it within two weeks if I had the time.</li>
<li><strong>Shell</strong>: Used to write simple scripts for tasks like automated deployment, backups, and cleanup.</li>
<li><strong>JavaScript</strong>: Used for writing simple AJAX. Planning to learn TypeScript and React when I have time.</li>
<li><strong>Rust</strong>: A language I am very eager to learn, though I am hesitant due to job opportunities. I plan to learn it once my situation is more stable.</li>
</ul>
<h3 id="domain-knowledge">Domain Knowledge</h3>
<ul>
<li><strong>Backend Technologies</strong>: Mainly web development, distributed systems, databases, caching, message queues, etc.</li>
<li><strong>Cloud-Native Technologies</strong>: Mainly Kubernetes, Docker, Helm, ArgoCD, Argo Workflow, etc.</li>
<li><strong>Computer Networks</strong>: Mainly TCP/IP, HTTP, HTTPS, WebSocket, etc.</li>
<li><strong>Machine Learning</strong>: Deep learning, reinforcement learning. I&rsquo;ve worked with PyTorch, TensorFlow, Keras, etc.</li>
<li><strong>Data Analysis</strong>: Data processing, data visualization. Proficient with pandas, numpy, matplotlib, seaborn, etc.</li>
</ul>
<h3 id="in-progress">In Progress</h3>
<ul>
<li><strong>Leetcode Algorithms</strong>: Continuously practicing, seems endless&hellip;</li>
<li><strong>Go Projects</strong>: Working on some projects to systematically review Go&rsquo;s syntax and various data components.</li>
<li><strong>Kubernetes</strong>: Currently studying it, hoping to produce some articles about Kubernetes.</li>
<li><strong>C++</strong>: Currently reading, two chapters per week.</li>
<li><strong>Model-based Reinforcement Learning for Industrial Applications</strong>: Working on this project with my professor, almost ready to write a paper.</li>
</ul>
<h2 id="my-life">My Life</h2>
<p>In my spare time, I hang out with friends and recently went to Malaysia for a trip. I enjoy eating, playing games, and reading manga. Anyone else a fan of &ldquo;Baki&rdquo; and &ldquo;Kengan Ashura&rdquo;?</p>
]]></content>
        </item>
        
        <item>
            <title>English in Action</title>
            <link>https://Greenery-S.github.io/posts/english-learning/daily/english-in-action/</link>
            <pubDate>Sun, 19 May 2024 00:07:10 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/english-learning/daily/english-in-action/</guid>
            <description>English Learning Daily When composing my blog, I initially write in Chinese and then translate the content into English. This approach allows me to practice English more effectively and gain a deeper understanding of the differences between Chinese and English.
While writing the blog, I have the opportunity to learn new English vocabulary and expressions. This method has proven to be highly beneficial for my language learning process.
I analyze the English translations provided by ChatGPT, noting the vocabulary, expressions, and grammar used.</description>
            <content type="html"><![CDATA[<h1 id="english-learning-daily">English Learning Daily</h1>
<p>When composing my blog, I initially write in Chinese and then translate the content into English. This approach allows me to practice English more effectively and gain a deeper understanding of the differences between Chinese and English.</p>
<p>While writing the blog, I have the opportunity to learn new English vocabulary and expressions. This method has proven to be highly beneficial for my language learning process.</p>
<p>I analyze the English translations provided by ChatGPT, noting the vocabulary, expressions, and grammar used. This analytical approach significantly enhances my English learning experience.</p>
<p>The articles in this series are named using the format: 20010203-english-in-blog.md, where 20010203 represents the date, and english-in-blog is the article title.</p>
]]></content>
        </item>
        
        <item>
            <title>Classification</title>
            <link>https://Greenery-S.github.io/posts/hugo/site-building/classification/</link>
            <pubDate>Sat, 18 May 2024 21:10:35 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/hugo/site-building/classification/</guid>
            <description>Article Classification System The classification of articles is managed by two fields: tags and categories. Tags are used for more casual classifications, such as golang and gopher, while categories are used for more formal topic classifications, such as go-dual-token-blog-system.
The URLs for the lists of tags and categories are /tags/ and /categories/, respectively. These URLs are set in the navigation bar, making it easy to view all tags and categories.</description>
            <content type="html"><![CDATA[<h1 id="article-classification-system">Article Classification System</h1>
<p>The classification of articles is managed by two fields: tags and categories. Tags are used for more casual classifications, such as golang and gopher, while categories are used for more formal topic classifications, such as go-dual-token-blog-system.</p>
<p>The URLs for the lists of tags and categories are /tags/ and /categories/, respectively. These URLs are set in the navigation bar, making it easy to view all tags and categories.</p>
<p>One thing to note is that the default sorting method for these lists is by time, so it is advisable to avoid having too many tags and categories, as this could lead to a cluttered list page.</p>
<h2 id="tags">Tags</h2>
<p>The values for tags can be filled in freely, such as golang and gopher. Any semantic tag can be used. Tags are set in the front matter of markdown files and can have multiple tags.</p>
<p>It is recommended to use singular forms for tags, such as rule instead of rules, to avoid duplicate tags.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">tags</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">golang</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">gopher</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">hugo</span>
</span></span></code></pre></div><h2 id="categories">Categories</h2>
<p>The values for categories are used for topic classifications, such as go-project-dual-token-blog-system. They are set in the front matter of markdown files.</p>
<p>Categories are hierarchical; for example, go is a primary category, go-project is a secondary category, and go-project-dual-token-blog-system is a tertiary category. Subcategories must include their parent categories. For an article under the go-project-dual-token-blog-system category, the categories field should be filled out as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">categories</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">go</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">go-project</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ae81ff">go-project-dual-token-blog-system</span>
</span></span></code></pre></div><p>An article might fall under two main categories; for example, this article could be under both hugo and go main categories. Such dual categorization should be carefully considered and not done haphazardly.</p>
]]></content>
        </item>
        
        <item>
            <title>Two-Year Old Gopher</title>
            <link>https://Greenery-S.github.io/posts/go/two-year-old-gopher/</link>
            <pubDate>Sat, 18 May 2024 20:49:02 +0800</pubDate>
            
            <guid>https://Greenery-S.github.io/posts/go/two-year-old-gopher/</guid>
            <description>A Two-Year Go Language User I started learning Go language in October 2022, and now it has been two years. During this time, I have gained a certain level of understanding of Go and have had some practical experience using it in my work. I&amp;rsquo;d like to share some of my thoughts on Go.
Why Learn Go? I was choosing a technology that would help me establish myself in China’s internet industry.</description>
            <content type="html"><![CDATA[<h1 id="a-two-year-go-language-user">A Two-Year Go Language User</h1>
<p>I started learning Go language in October 2022, and now it has been two years. During this time, I have gained a certain level of understanding of Go and have had some practical experience using it in my work. I&rsquo;d like to share some of my thoughts on Go.</p>
<h2 id="why-learn-go">Why Learn Go?</h2>
<p>I was choosing a technology that would help me establish myself in China’s internet industry. The pandemic had just ended, and recent graduates were saying that the job market for Java was tough and it was hard to find work. As a junior in college, I decided to study abroad, and with two years left until graduation, I was quite confused. I asked my uncle, who is a seasoned programmer, for advice, and he suggested I try Go, which they were also using.</p>
<h2 id="the-long-learning-journey">The Long Learning Journey</h2>
<p>So, I began learning this language. I must thank him because, for a novice programmer, Go is very comfortable to learn. Both Go and Rust, as emerging languages, have very clear learning paths and almost no historical baggage, which is very friendly for beginners.</p>
<p>I learned Go’s syntax, concurrency, some data components’ Go SDKs, and various Go frameworks. I found Go’s concurrency very easy to use, its SDKs quite rich, and its frameworks numerous. I used Go at work to write some small tools and services.</p>
<p>I also attended GoCN&rsquo;s offline event in Beijing, where I met fellow Go enthusiasts. It was the first event after the pandemic, held in Beijing. The day before, I was still in Lhasa, but on a whim, I rushed to Beijing overnight and was kindly hosted by Jiang Da-ge. I was very happy during my time in Beijing.</p>
<p>The star projects of Go are Docker and Kubernetes (K8s), both written in Go. The success of these projects has given Go a prominent place in the cloud computing field, firmly establishing it alongside older, strong languages like Java and C++.</p>
<p>Later, I also studied cloud-native technologies, though I am still in the learning process. I feel I need to study them systematically because I am deeply involved in this field. Go has greatly helped me. I became an intern at TikTok Cloud Infra in Singapore, where I have learned a lot.</p>
<h2 id="the-road-ahead-is-long">The Road Ahead is Long</h2>
<p>Coming to Singapore and working with Go is the best arrangement for me. I may need to continue improving my Go skills, learn more cloud-native technologies, and perhaps study other things as well. But I believe I will keep going until I no longer enjoy this industry.</p>
<p>Of course, becoming a full-time employee from an intern requires significant effort. Given the circumstances, I need to study LeetCode algorithms, general backend technologies with Go, and Kubernetes-centric cloud-native technologies. I may also need to learn other languages and technologies, such as systematically studying C++ or PyTorch, to ensure my employability.</p>
<h2 id="what-will-this-topic-include">What Will This Topic Include?</h2>
<p>Currently, I plan to include some of the general backend knowledge points I have worked on in this Go series. In the near future, this Go series will include at least the following content:</p>
<ul>
<li><strong>Database Series</strong></li>
<li><strong>Message Queue Series</strong></li>
<li><strong>Security and Encryption Series</strong></li>
<li><strong>Network Programming Series</strong></li>
<li>Practice Projects:
<ul>
<li><strong>Blog System</strong>: Actually the predecessor of this website, a monolithic application based on the Gin framework, with all components including MySQL and Redis containerized. The authentication part designed a dual-token mechanism. Maintenance costs were high, so I switched to Hugo.</li>
<li><strong>Lottery System</strong>: This will be a practice project integrating high concurrency techniques.</li>
<li><strong>GPC Framework</strong>: An RPC framework based on Go, where I will implement a simple RPC framework.</li>
<li><strong>Distributed Search System</strong>: A more advanced practice project involving some knowledge of distributed systems.</li>
</ul>
</li>
</ul>
<p>The basic syntax of Go and its concurrency might not be included soon, as they are both very large topics and will take time to organize</p>
]]></content>
        </item>
        
    </channel>
</rss>
